<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Potluck Events</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.7/dist/umd/supabase.min.js"></script>

<style>
body { font-family: system-ui, sans-serif; background:#f5f7fa; padding:16px }
button {
  padding:10px 14px;
  border:none;
  border-radius:8px;
  background:#4f46e5;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}
</style>
</head>

<body>

<h1>Potluck Planner</h1>
<p>Create a new potluck event to get started.</p>

<button id="create">Create New Event</button>

<script>
const SUPABASE_URL = "https://amayopmpqvkqbdlkbkog.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFtYXlvcG1wcXZrcWJkbGtia29nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4MTM3NTQsImV4cCI6MjA4NzM4OTc1NH0.7k5eEc3RY4COJMIvDtffwI2eGalY5k0CWARAEkuyJ-M";
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

function uid(){ return Math.random().toString(36).slice(2); }

document.getElementById('create').onclick = async () => {
  const event = {
    name: 'New Potluck Event',
    data: [
      {
        day: 'Day 1',
        notes: '',
        slots: [
          { id: uid(), time: 'Breakfast', meal_theme: '', items: [] },
          { id: uid(), time: 'Lunch', meal_theme: '', items: [] },
          { id: uid(), time: 'Dinner', meal_theme: '', items: [] }
        ]
      }
    ],
    locked: false
  };

  const { data, error } = await supabaseClient
    .from('events')
    .insert(event)
    .select()
    .single();

  if (error) {
    alert('Failed to create event');
    console.error(error);
    return;
  }

  location.href = `./event.html?event=${data.id}`;
};
</script>

</body>
</html>
